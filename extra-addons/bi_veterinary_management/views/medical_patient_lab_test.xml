<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <record id="view_medical_tree_lab_req" model="ir.ui.view">
            <field name="name">view.tree.medical.lab.request</field>
            <field name="model">medical.patient.lab.test</field>
            <field name="arch" type="xml">
                <tree string="Test Requests">

                    <field name="request" readonly="1" />
                    <field name="name" required="1" />
                    <field name="date" />
                    <field name="patient_id" required="1" />
                    <field name="doctor_id" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record id="view_medical_lab_req" model="ir.ui.view">
            <field name="name">view.medical.lab.request</field>
            <field name="model">medical.patient.lab.test</field>
            <field name="arch" type="xml">
                <form string="Test Requests">
                    <header>
                        <button name="create_lab_test" type="object"
                            states="draft" string="Create Lab Test" />
                    </header>

                    <sheet string="Medical Lab Request">
                        <group colspan="4" col="4">
                            <field name="request" readonly="1" />
                            <field name="name" required="1" />
                            <field name="date" />
                            <field name="owner_id" />
                            <field name="patient_id" required="1" />
                            <field name="doctor_id" />
                            <field name="state" />
                            <field name="urgent" />
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="action_tree_view_lab_requests" model="ir.actions.act_window">
            <field name="name">Lab Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">medical.patient.lab.test</field>
            <field name="binding_view_types">tree</field>
            <field name="view_mode">tree</field>
        </record>

        <record id="action_view_lab_requests" model="ir.actions.act_window">
            <field name="name">Draft Lab Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">medical.patient.lab.test</field>
            <field name="binding_view_types">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','=','draft')]</field>
        </record>

        <record id="action_view_today_lab_requests" model="ir.actions.act_window">
            <field name="name">Today's Draft Lab Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">medical.patient.lab.test</field>
            <field name="binding_view_types">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','=','draft'),('date','>=',time.strftime('%Y-%m-%d'))]
            </field>
        </record>

        <record id="action_lab_to_invoice" model="ir.actions.act_window">
            <field name="name">Lab Requests to be invoiced</field>
            <field name="res_model">medical.patient.lab.test</field>
            <field name="binding_view_types">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_today_lab_req" model="ir.actions.act_window">
            <field name="name">Lab Test Requests</field>
            <field name="res_model">medical.patient.lab.test</field>
            <field name="binding_view_types">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <act_window id="action_create_lab_result" name="Create Lab Result"
            res_model="medical.lab.test.create" binding_model="medical.patient.lab.test"
            view_mode="form" target="new" />


        <act_window id="action_create_lab_invoice" name="Create Lab Invoice"
            res_model="medical.lab.test.invoice" binding_model="medical.patient.lab.test"
            view_mode="form" target="new" />

         <menuitem name="Lab Requests"
            id="menu_lab_requests"
            parent = "bi_veterinary_management.main_menu_laboratory"
            />

        <menuitem name="Draft Lab Requests" id="sub_menu_draft_req"
            parent="menu_lab_requests" action="action_view_lab_requests" />

        <menuitem name="Today's Draft Lab Requests" id="sub_menu_today_draft_req"
            parent="menu_lab_requests" action="action_view_today_lab_requests" />

        <menuitem id="lab_to_invoice" action="action_lab_to_invoice"
            string="Lab Request to be Invoiced" parent="Invoice"
            sequence="1" />

        <menuitem id="today_lab_req" action="action_today_lab_req"
            string="Today's Lab Request" parent="Invoice" sequence="2" />

</odoo>

<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<template id="argos_product_detail_inherited" inherit_id="website_sale.product" name="Product Details">

        <xpath expr="//ol[hasclass('breadcrumb')]" position="replace">
            <ol class="breadcrumb mb32">
                <li class="breadcrumb-item">
                    <a href="/shop">Boutique</a>
                </li>
                <t t-if="product.public_categ_ids">
                    <li class="breadcrumb-item">
                       <t t-foreach="product.public_categ_ids" t-as="categs">
                            <a t-att-href="'/shop/category/%s' % slug(categs)">
                                <span class="categ-name">
                                    <t t-esc="categs.name"/>
                                </span>
                            </a>
                        </t>
                    </li>
                </t>
                <li class="breadcrumb-item active">
                    <span t-field="product.name" />
                </li>
            </ol>
        </xpath>

		<xpath expr="//div[hasclass('col-xl-8')]" position="attributes">
	        <attribute name="class">col-lg-6 col-xl-6 mb-4 mb-lg-0</attribute>
	    </xpath>

	    <xpath expr="//div[@id='product_details']" position="replace">
            <div class="col-lg-6 col-xl-6" id="product_details">
            	<div class="category-wish d-flex align-items-center mb16">
            		<t t-set="gamne_value" t-value="website.get_product_gamne_values(product)"/>
                    <t t-if="gamne_value">
                        <div class="argos_categ">
                            <p>
                                <t t-foreach="gamne_value" t-as="gv">
                                    <a 
                                    t-att-href="website.default_category(gv)"
                                    role="button">
                                        <span class="categ-name">
                                            <t t-esc="gv.name"/>
                                        </span>
                                    </a>    
                                </t>
                            </p>
                        </div>
                    </t>
            		<div class="ml-auto">
                        <a type="button" role="button"
                            class="btn btn-default o_add_wishlist te_theme_button"
                            t-att-disabled='in_wish or None' title="Add to Wishlist"
                            t-att-data-product-product-id="product.product_variant_ids[0].id if product.product_variant_ids else '0'"
                            data-action="o_wishlist">Ajouter aux favoris
                            <img src="/website_argos/static/src/img/heart.png" class="img img-fluid ml-2" alt="Add To Wishlist"/></a>
                    </div>
            	</div>

                <t t-if="product.tag_ids">
                    <div class="argos_tags d-flex align-items-center mb16">
                        <t t-foreach="product.tag_ids" t-as="tags">
                            <div class="tag-name">
                                <a t-att-href="'/shop?tag_id=%s' % tags.id" class="">
                                    <t t-esc="tags.name"/>
                                </a>
                            </div>
                        </t>
                    </div>
                </t>
            	<div class="product-name-share">
                    <h1 itemprop="name" t-field="product.name" class="product-name m-0">Product Name</h1>
                    <div class="product_ref_code mt16 mb16">
                        <t t-call="website_argos.product_item_stars"/> 
                    </div>
                </div>
                <span itemprop="url" style="display:none;" t-esc="product.website_url"/>
                <form t-if="product._is_add_to_cart_possible()" action="/shop/cart/update" method="POST">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <div class="js_product js_main_product">
                        <div id="product_option_block" class="d-none"/>
                        <t t-call="website_sale.product_price" />
                        <p t-field="product.description_sale" class=" mt-3 description" placeholder="A short description that will also appear on documents." />
                        <div class="line mt16 mb16"/>
                        <t t-placeholder="select">
                            <input type="hidden" class="product_id" name="product_id" t-att-value="product_variant.id" />
                            <input type="hidden" class="product_template_id" name="product_template_id" t-att-value="product.id" />
                            <t t-if="combination" t-call="sale.variants">
                                <t t-set="ul_class" t-value="'flex-column'" />
                                <t t-set="parent_combination" t-value="None" />
                            </t>
                            <t t-else="">
                                <ul class="d-none js_add_cart_variants" t-att-data-attribute_exclusions="{'exclusions: []'}"/>
                            </t>
                        </t>
                        <p t-if="True" class="css_not_available_msg alert alert-warning">This combination does not exist.</p>
                        <div>
                            <div id="product_attributes_simple">
                                <p class="text-muted">
                                    <t t-set="single_value_attributes" t-value="product.valid_product_template_attribute_line_ids._prepare_single_value_for_display()"/>
                                    <t t-foreach="single_value_attributes" t-as="attribute">
                                        <span t-field="attribute.name" class="attribute_name"/>:
                                        <t t-foreach="single_value_attributes[attribute]" t-as="ptal">
                                            <span class="attribute_value" t-field="ptal.product_template_value_ids._only_active().name"/><t t-if="not ptal_last">, </t>
                                        </t>
                                        <br/>
                                    </t>
                                </p>
                            </div>
                        </div>
                        <div class="cart-quantity d-flex align-items-center">
	                        <t t-if="request.website.viewref('website_sale.product_quantity').active">
	                            <div class="css_quantity input-group d-flex align-items-center" contenteditable="false">
	                                <div class="control-qty-cart ">
	                                    <div class="control-qty d-flex">
	                                        <div class="input-group-prepend">
                                                <a t-attf-href="#" class="btn qty_remove js_add_cart_json" aria-label="Remove one" title="Remove one">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                            </div>
	                                        <input type="text" class="form-control quantity" data-min="1" name="add_qty" t-att-value="add_qty or 1"/>
                                            <div class="input-group-append">
                                                <a t-attf-href="#" class="btn qty_add float_left js_add_cart_json" aria-label="Add one" title="Add one">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
	                                        
	                                    </div>
	                                </div>
	                            </div>
	                        </t>
	                        <a role="button" id="add_to_cart" class="btn btn-default btn-lg js_check_product a-submit  d-flex" href="#"><img src="/website_argos/static/src/img/white-cart.png" class="img img-fluid"/>Ajouter
							<span class="text-white ml-1 mr-1 text-bold"> - </span>
							<t t-call="website_sale.product_price" /></a>
						</div>
						<div class="text">
							<span class="image">
								<img src="/website_argos/static/src/img/check.png" class="img img-fluid mr-2"/>
							</span>
							<span class="text-primary">Livraison gratuite en Click &amp; Collect chez votre vétérinaire en 48h</span>
						</div>
                    </div>
                </form>
                <p t-elif="not product.active" class="alert alert-warning">This product is no longer available.</p>
                <p t-else="" class="alert alert-warning">This product has no valid combination.</p>
            </div>
        </xpath>
	</template>

	<template id="products_tab_bizople" inherit_id="website_sale.product" name="Product Tab Bizople" priority="25">
        <xpath expr="//section[@id='product_detail']" position="after">
            <t t-set="first" t-value="0"/>
            <t t-set="review_enabled" t-value="request.website.viewref('website_sale.product_comment').active"/>
            <t t-set="specification_enabled" t-value="request.website.viewref('website_sale_comparison.product_attributes_body').active"/>
            <div class="col-lg-12 col-md-12 pt48 pb48 product_tabs">
                <div class="container">
                    <div class="main-tab">
                        <ul class="nav nav-tabs tabs" role="tablist" id="product_detail_tabs">
                            <t t-if="product.website_description or request.env.user._is_admin()">
                                <li class="nav-item" priority="1">
                                    <a class="nav-link active show" id="nav-home-tab1" data-toggle="tab" href="#nav-home1" role="tab" aria-controls="nav-home1" aria-selected="true">
                                        Description
                                    </a>
                                </li>
                            </t>
                            
                            <t t-if="product.valid_product_template_attribute_line_ids._prepare_categories_for_display()">
                                <li class="nav-item" priority="1">
                                    <a class="nav-link product_description" id="nav-home-tab2" data-toggle="tab" href="#nav-home2" role="tab" aria-controls="nav-home2" aria-selected="false">
                                        Specification
                                    </a>
                                </li>
                            </t>
                            <!-- 
                            <t t-if="review_enabled">
                                <li class="nav-item" priority="1">
                                    <a class="nav-link" id="nav-home-tab3" data-toggle="tab" href="#nav-home3" role="tab" aria-controls="nav-home3" aria-selected="false">
                                        Reviews
                                    </a>
                                </li>
                            </t> -->
                            
                            <t t-foreach="product.tab_ids" t-as="tab">
                                <li class="nav-item">
                                    <a class="nav-link o_default_snippet_text" t-att-id="'nav_link_%s_%s' % (product.id, tab.id)" data-toggle="tab" t-att-href="'#nav_tabs_body_%s_%s' % (product.id, tab.id)"  role="tab" t-att-aria-controls="'nav_link_%s_%s' % (product.id, tab.id)" aria-selected="false">
                                        <t t-esc="tab.name"/>
                                    </a>
                                </li>
                            </t>
                        </ul>
                    </div>
                    <div class="card-body tab-content product-tab mt32">
                        <div class="tab-pane fade active show" id="nav-home1" role="tabpanel" aria-labelledby="nav-home-tab1">
                            <div itemprop="description" t-field="product.website_description" class="oe_structure mt16" id="product_full_description" />
                        </div>
                        <t t-if="specification_enabled">
                            <div class="tab-pane fade" id="nav-home2" role="tabpanel" aria-labelledby="nav-home-tab2">
                            <section class="container" id="product_full_spec">
                                <t t-set="categories" t-value="product.valid_product_template_attribute_line_ids._prepare_categories_for_display()"/>
                                <t t-if="categories">
                                    <h3 class="text-center mb32 d-none">Specifications for <t t-esc="product.name"/></h3>
                                    <div class="row">
                                        <div class='col-lg-12' id='product_specifications'>
                                            <table class='table table-striped table-sm table-hover'>
                                                <t t-foreach="categories" t-as="category">
                                                    <t t-if="len(categories) > 1">
                                                        <tr class="clickable" data-toggle="collapse" t-att-data-target="'.o_ws_category_%d' % category.id">
                                                            <th class="text-left" t-att-colspan="2">
                                                                <span t-if="category" t-field="category.name"/>
                                                                <span t-else="">Uncategorized</span>
                                                            </th>
                                                        </tr>
                                                    </t>
                                                    <tr t-foreach="categories[category].filtered(lambda l: len(l.value_ids) > 1)" t-as="ptal" t-att-class="'collapse show o_ws_category_%d' % category.id">
                                                        <td><span t-field="ptal.attribute_id.name"/></td>
                                                        <td>
                                                            <t t-foreach="ptal.value_ids" t-as="pav">
                                                                <span t-field="pav.name"/><t t-if="not pav_last"> or</t>
                                                            </t>
                                                        </td>
                                                    </tr>
                                                    <t t-set="single_value_attributes" t-value="categories[category]._prepare_single_value_for_display()"/>
                                                    <tr t-foreach="single_value_attributes" t-as="attribute" t-att-class="'collapse show o_ws_category_%d' % category.id">
                                                        <td><span t-field="attribute.name"/></td>
                                                        <td>
                                                            <t t-foreach="single_value_attributes[attribute]" t-as="ptal">
                                                                <span t-field="ptal.product_template_value_ids._only_active().name"/><t t-if="not ptal_last">, </t>
                                                            </t>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </table>
                                        </div>
                                    </div>
                                </t>
                            </section>
                        </div>
                        </t>
                        <!-- <t t-if="review_enabled">
                        <div class="tab-pane fade" id="nav-home3" role="tabpanel" aria-labelledby="nav-home-tab3">
                            <div class="o_shop_discussion_rating">
                                <section class="container mt16 mb16">
                                    <hr/>
                                    <div class="row">
                                        <div class="col-lg-8 offset-lg-2">
                                            <t t-call="portal.message_thread">
                                                <t t-set="object" t-value="product"/>
                                                <t t-set="display_rating" t-value="True"/>
                                            </t>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        </div>
                        </t> -->
                        <t t-foreach="product.tab_ids" t-as="tab">
                            <div t-att-id="'nav_tabs_body_%s_%s' % (product.id, tab.id)" class="tab-pane fade" role="tabpanel" t-att-aria-labelledby="'nav_link_%s_%s' % (product.id, tab.id)">
                                <section class="mt16 mb16">
                                    <div t-field="tab.content" class="oe_structure" />
                                </section>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="product_attributes_body_bizople" inherit_id="website_sale_comparison.product_attributes_body" priority="20" >
        <xpath expr="//section[@id='product_full_spec']//div" position="replace" />
        <xpath expr="//section[@id='product_full_spec']//h3" position="replace" />
    </template>

    <!-- <template id="discussion_rating_bizople" inherit_id="website_sale.product_comment">
        <xpath expr="//div[hasclass('o_shop_discussion_rating')]" position="replace">
        </xpath>
    </template> -->

    <template id="product_description_bizople" inherit_id="website_sale.product">
         <xpath expr="//div[@id='product_full_description']" position="attributes">
                <attribute name="class" separator=" " add="d-none" />
        </xpath>
    </template>

    <template id="alt_product_item_stars" name="Rating: static star widget">
        <t t-set="rating_avg" t-value="round(alt_product.rating_avg * 100) / 100 / 2"/>
        <t t-set="val_decimal" t-value="round(rating_avg % 1, 1)"/>
        <t t-set="val_integer" t-value="int(rating_avg)"/>
        <t t-set="empty_star" t-value="5 - (val_integer+1) if val_decimal else 5 - val_integer"/>
        <div class="" t-att-style="inline_mode and 'display:inline'" t-att-title="rating_avg">
            <t t-foreach="range(0, val_integer)" t-as="num">
                <i class="fa fa-star" role="img"></i>
            </t>
            <t t-if="val_decimal">
                <i class="fa fa-star-half-o" role="img"></i>
            </t>
            <t t-foreach="range(0, empty_star)" t-as="num">
                <i class="fa fa-star-o text-secondary" role="img"></i>
            </t>
            <span style="margin-left:2px;" class="text1">
                <t t-esc="rating_avg"/><span> / 5</span>
            </span>
            <span style="margin-left:5px;font-size:15px;" class="text2">Voir les 
            <t t-esc="alt_product.rating_count"/><span style="margin-left:5px;font-size:15px;">avis</span></span>
        </div>
    </template>

    <template id="theme_common_alternative_product_inherited" inherit_id="website_sale.recommended_products">
        <xpath expr="//div[hasclass('container','mt32')]" position="attributes">
             <attribute name="class" separator=" " add="alternative_product" />
        </xpath>
        <xpath expr="//span[hasclass('h3')]" position="replace">
            <h3>Articles associés</h3>
        </xpath>
        <xpath expr="//div[hasclass('col-lg-2')]" position="replace">
            <div class="col-lg-3 col-md-3 pt16 pb112 alternative_product1">
                <div class="text-center alt_product" style="height: 100%;">
                     <t t-if="alt_product.tag_ids">
                        <div class="argos_tags mb16">
                            <t t-foreach="alt_product.tag_ids" t-as="tags">
                                <div class="tag-name">
                                    <a t-att-href="'/shop?tag_id=%s' % tags.id" class="">
                                        <t t-esc="tags.name"/>
                                    </a>
                                </div>
                            </t>
                        </div>
                    </t>
                    <t t-set="combination_info" t-value="alt_product._get_combination_info()"/>
                    <t t-set="product_variant" t-value="alt_product.env['product.product'].browse(combination_info['product_id'])"/>
                    <div t-if="product_variant" t-field="product_variant.image_128" t-options="{'widget': 'image', 'preview_image': 'image_1024' if product_image_big else 'image_256'}"
                        class="d-flex h-100 justify-content-center align-items-center" />
                    <div t-else="" t-field="alt_product.image_128" t-options="{'widget': 'image', 'qweb_img_responsive': False, 'class': 'rounded shadow o_alternative_product' }" />
                    <t t-set="gamne_value" t-value="website.get_product_gamne_values(alt_product)"/>
                    <t t-if="gamne_value">
                        <div class="argos_categ">
                            <p>
                                <t t-foreach="gamne_value" t-as="gv">
                                    <a 
                                    t-att-href="website.default_category(gv)"
                                    role="button">
                                        <span class="categ-name">
                                            <t t-esc="gv.name"/>
                                        </span>
                                    </a>    
                                </t>
                            </p>
                        </div>
                    </t>
                    <h6>
                        <a t-att-href="alt_product.website_url" style="display: block">
                            <span t-att-title="alt_product.name" t-field="alt_product.name" class="o_text_overflow" style="display: block;" />
                        </a>
                    </h6>
                    
                    <div class="pro-rating">
                        <t t-call="website_argos.alt_product_item_stars"/>
                    </div>

                    <div class="product_price" itemprop="offers" itemscope="itemscope" itemtype="http://schema.org/Offer">
                        <del t-attf-class="text-danger mr-2 {{'' if combination_info['has_discounted_price'] else 'd-none'}}" style="white-space: nowrap;" t-esc="combination_info['list_price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" />
                        <span t-if="combination_info['price']" t-esc="combination_info['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                        <span itemprop="price" style="display:none;" t-esc="combination_info['price']" />
                        <span itemprop="priceCurrency" style="display:none;" t-esc="website.currency_id.name" />
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="product_rating_inherited" inherit_id="website_sale.product_comment">
         <xpath expr="//div[hasclass('col-lg-8')]" position="attributes">
            <attribute name="class">col-lg-12 col-md-12</attribute>
         </xpath>
         <xpath expr="//t[@t-call='portal.message_thread']" position="inside">
            <t t-foreach="rating" t-as="rat">
                <h5 class="mb-1"><t t-esc="rat.publisher_name"/></h5>
            </t>
         </xpath>
    </template>
</odoo>
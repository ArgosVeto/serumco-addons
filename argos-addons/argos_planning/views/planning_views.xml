<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <record id="planning_slot_view_search_inherit" model="ir.ui.view">
      <field name="name">planning.slot.search.inherit</field>
      <field name="model">planning.slot</field>
      <field name="inherit_id" ref="planning.planning_view_search"/>
      <field name="arch" type="xml">
        <xpath expr="//filter[@name='past']" position="after">
          <filter name="unexpected_rdv" string="Unexpected appointment" domain="[('unexpected_rdv', '=', True)]"/>
          <filter name="active_rdv" string="Active appointment"
                  domain="[('state', 'not in', ['cancel','not_honored'])]"/>
        </xpath>
        <xpath expr="//filter[@name='open_shifts']" position="replace"/>
      </field>
    </record>

    <record id="planning_view_form_quickcreate_inherit" model="ir.ui.view">
      <field name="name">planning.slot.form.quickcreate.inherit</field>
      <field name="model">planning.slot</field>
      <field name="inherit_id" ref="planning.planning_view_form_quickcreate"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='employee_id']" position="after">
          <field name="operating_unit_id"/>
          <field name="patient_id"/>
          <field name="partner_id" required="1"/>
          <field name="consultation_type_id"/>
          <field name="more_info" string="More customer info"/>
        </xpath>
      </field>
    </record>

    <record id="planning_slot_view_calendar_inherit" model="ir.ui.view">
      <field name="name">planning.slot.view.calendar.inherit</field>
      <field name="model">planning.slot</field>
      <field name="inherit_id" ref="planning.planning_view_calendar"/>
      <field name="arch" type="xml">
        <xpath expr="//calendar" position="attributes">
          <attribute name="color">state</attribute>
          <attribute name="all_day">allday</attribute>
        </xpath>
        <xpath expr="//field[@name='employee_id']" position="after">
          <field name="operating_unit_id"/>
        </xpath>
        <field name="name" position="before">
          <field name="state" readonly="1"/>
        </field>
      </field>
    </record>

    <record id="planning_slot_view_tree_inherit" model="ir.ui.view">
      <field name="name">planning.slot.view.tree.inherit</field>
      <field name="model">planning.slot</field>
      <field name="inherit_id" ref="planning.planning_view_tree"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='allocated_hours']" position="after">
          <field name="arrival_time" widget="timer" string="Waiting Time"/>
          <field name="pickup_time" invisible="1"/>
          <field name="state"/>
        </xpath>
      </field>
    </record>

    <record id="planning_slot_view_form_inherit" model="ir.ui.view">
      <field name="name">planning.slot.view.form.inherit</field>
      <field name="model">planning.slot</field>
      <field name="inherit_id" ref="planning.planning_view_form"/>
      <field name="arch" type="xml">
        <xpath expr="//div[@role='alert']" position="after">
          <div role="alert" class="alert-warning p-3 text-center" attrs="{'invisible': [('total_due', '=', 0)]}">
            <button name="open_action_followup" type="object" class="btn-link">
              <field name="total_due" widget="monetary"/>
              total due
            </button>
            <span class="align-middle">for this customer.</span>
          </div>
          <header>
            <button name="button_set_to_draft" type="object" class="btn btn-primary" string="Set to Draft"
                    attrs="{'invisible': [('state', 'not in', ['cancel'])]}"/>
            <button name="button_validate" type="object" class="btn btn-primary" string="Validate"
                    attrs="{'invisible': [('state', 'not in', ['draft'])]}"/>
            <button name="button_set_to_waiting" type="object" class="btn btn-primary" string="Waiting"
                    attrs="{'invisible': [('state', 'not in', ['validated'])]}"/>
            <button name="button_progress" type="object" class="btn btn-primary" string="New consultation"/>
            <button name="button_cancel" type="object" string="Cancel"
                    attrs="{'invisible': [('state', 'not in', ['draft', 'validated'])]}"/>
            <button name="button_not_honored" type="object" string="Not honored"
                    attrs="{'invisible': [('state', 'not in', ['draft', 'validated'])]}"/>
            <field name="state" widget="statusbar"/>
          </header>
        </xpath>
        <field name="is_assigned_to_me" position="before">
          <div class="oe_button_box" name="button_box">
            <button attrs="{'invisible': [('arrival_time', '=', False)]}">
              <field name="arrival_time" widget="timer" class="text-danger h2 pull-right mr-4 font-weight-bold"/>
            </button>
          </div>
        </field>
        <xpath expr="//sheet/group[2]/group[1]" position="replace">
          <group>
            <field name="source" invisible="1"/>
            <field name="mrdv_event_id" invisible="1"/>
            <field name="mrdv_job_id" invisible="1"/>
            <field name="patient_ids" invisible="1"/>
            <field name="role_type" invisible="1"/>
            <field name="pickup_time" invisible="1"/>
            <field name="partner_id" attrs="{'required': [('background_event','=',False),('role_type','=','rdv')]}"/>
            <field name="patient_id" domain="[('id','in',patient_ids)]"
                   attrs="{'required': [('background_event','=',False),('role_type','=','rdv')]}"
                   context="{'form_view_ref': 'argos_contact.res_partner_view_form','tree_view_ref': 'argos_contact.res_partner_view_tree', 'default_contact_type': 'patient'}"/>
            <field name="consultation_type_id" string="Appointment nature"/>
            <field name="more_info" string="More customer info"/>
          </group>
        </xpath>
        <xpath expr="//sheet/group[2]/group[2]" position="replace">
          <group>
            <field name="active" invisible="1"/>
            <field name="employee_id" string="Veterinary"/>
            <field name="role_id"/>
            <field name="operating_unit_id"/>
            <field name="company_id" groups="base.group_multi_company" string="Agglomeration"/>
          </group>
        </xpath>
        <xpath expr="//sheet/group[3]" position="replace">
          <group>
            <group>
              <field name="start_datetime" string="Start date"/>
              <field name="end_datetime" string="End date"/>
              <field name="allocated_hours" widget="float_time"/>
              <field name="allocated_percentage" groups="planning.group_planning_show_percentage"/>
            </group>
            <group>
              <field name="allday" invisible="1"/>
              <field name="background_event"/>
              <field name="unexpected_rdv"/>
              <field name="repeat" groups="planning.group_planning_manager"/>
              <label for="repeat_interval" string="Repeat Every" attrs="{'invisible': [('repeat', '=', False)]}"/>
              <div class="o_row" attrs="{'invisible': [('repeat', '=', False)]}">
                <field name="repeat_interval" class="oe_inline" nolabel="1"/>
                <span>week(s)</span>
                <field name="repeat_type" class="oe_inline" nolabel="1" attrs="{'required': [('repeat', '=', True)]}"/>
                <field name="repeat_until" class="oe_inline"
                       attrs="{'invisible': [('repeat_type', '!=', 'until')], 'required': [('repeat_type', '=', 'until')]}"
                       nolabel="1"/>
              </div>
            </group>
          </group>
        </xpath>
        <xpath expr="//sheet" position="after">
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="activity_ids" widget="mail_activity"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </xpath>
      </field>
    </record>

    <record id="planning_role_view_tree_inherit" model="ir.ui.view">
      <field name="name">planning.role.view.tree.inherit</field>
      <field name="model">planning.role</field>
      <field name="inherit_id" ref="planning.planning_role_view_tree"/>
      <field name="arch" type="xml">
        <field name="name" position="after">
          <field name="role_type"/>
          <field name="allday"/>
        </field>
      </field>
    </record>
  </data>
</odoo>
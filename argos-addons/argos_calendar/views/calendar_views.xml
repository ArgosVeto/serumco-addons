<?xml version="1.0"?>
<odoo>
  <record id="planning_view_agenda" model="ir.ui.view">
    <field name="name">planning.slot.agenda</field>
    <field name="model">planning.slot</field>
    <field name="priority">10</field>
    <field name="arch" type="xml">
      <calendar string="Agenda" date_start="start_datetime" date_stop="end_datetime" color="role_id" all_day="allday"
                form_view_id="%(argos_planning.planning_slot_view_form_inherit)d" event_open_popup="true"
                quick_add="False">
        <field name="state" readonly="1"/>
        <field name="name" string="RDV Reason"/>
        <field name="role_id" string="RDV Type"/>
        <field name="partner_id"/>
        <field name="patient_id"/>
        <field name="partner_phone"/>
        <field name="arrival_time"/>
        <field name="background_event" invisible="1"/>
        <field name="order_count" invisible="1"/>
        <field name="invoice_count" invisible="1"/>
      </calendar>
    </field>
  </record>

  <record id="agenda_calendar_action" model="ir.actions.act_window">
    <field name="name">Agenda</field>
    <field name="res_model">planning.slot</field>
    <field name="view_mode">calendar,tree,form</field>
    <field name="context">{'agenda_calendar': True, 'column': 'employee_id', 'search_default_active_rdv': 1}</field>
  </record>

  <record id="agenda_calendar_action_server" model="ir.actions.server">
    <field name="name">Agenda</field>
    <field name="model_id" ref="planning.model_planning_slot"/>
    <field name="state">code</field>
    <field name="code">action=env['planning.slot'].action_open_agenda()</field>
  </record>

  <menuitem
          id="agenda_menu_calendar"
          name="Agenda"
          sequence="20"
          parent="planning.planning_menu_my_planning"
          action="agenda_calendar_action_server"/>
</odoo>
